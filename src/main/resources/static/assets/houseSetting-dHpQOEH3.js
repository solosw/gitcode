import{_ as F,c as y,o as f,h as s,f as l,b as t,d as a,F as w,e as g,E as v,w as V,g as i,v as C,m as S,a as x,t as L,i as O}from"./index-oqa1SwAd.js";const z={created(){var e=new URLSearchParams(window.location.search).get("id");this.setting.houseId=e,g.post("/house/getHouseById/"+e).then(r=>{r.data.status==200&&(this.house=r.data.data)}),g.post("/house/getBranch/"+e).then(r=>{r.data.status==200&&(this.branches=r.data.data)}),g.post("/right/getUser/"+e).then(r=>{r.data.status==200?this.collaborators=r.data.data:v.error(r.data.message)})},data(){return{infovis:!1,setting:{right:"R",username:"",branch:"",houseId:-1},activeTab:"general",vis:!1,house:{name:"",description:"",visibility:"public",defaultBranch:"main"},branches:["main","dev"],collaborators:["user1","user2"],newCollaborator:"",saving:!1,isOwner:!0}},methods:{showCollaborator(u){this.infovis=!0},sureCollaborator(){g.post("/right/addUser",this.setting).then(u=>{u.data.status==200?(v.success("成功"),location.reload()):v.error(u.data.message)})},handleMenuSelect(u){this.activeTab=u},saveSettings(){this.saving=!0,setTimeout(()=>{this.saving=!1,this.$message.success("设置保存成功")},1e3)},addCollaborator(){this.vis=!0},removeCollaborator(u){this.$confirm("此操作将删除协作者，是否继续？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(()=>{g.post("/right/deleteUser/"+u.id+"/"+this.setting.houseId).then(e=>{e.data.status==200?(v.success("成功"),location.reload()):v.error(e.data.message)})})},deleteRepository(){this.$confirm("此操作将永久删除仓库，是否继续？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(()=>{this.$message.success("仓库删除成功")})}}},H={class:"settings-container"},j={class:"collaborators"},q={class:"add-collaborator",style:{float:"left"}},A={class:"danger-item"};function G(u,e,r,J,o,m){const _=a("el-menu-item"),I=a("el-menu"),k=a("el-col"),h=a("el-input"),d=a("el-form-item"),p=a("el-radio"),T=a("el-radio-group"),b=a("el-button"),U=a("el-form"),c=a("el-card"),N=a("el-tag"),W=a("el-divider"),D=a("el-popconfirm"),E=a("el-row"),B=a("el-option"),M=a("el-select"),R=a("el-dialog");return f(),y(w,null,[s("div",H,[l(E,{gutter:20},{default:t(()=>[l(k,{span:4},{default:t(()=>[l(I,{"default-active":o.activeTab,class:"settings-menu",onSelect:m.handleMenuSelect},{default:t(()=>[l(_,{index:"general"},{default:t(()=>e[8]||(e[8]=[s("i",{class:"el-icon-setting"},null,-1),s("span",null,"基础设置",-1)])),_:1}),l(_,{index:"branches"},{default:t(()=>e[9]||(e[9]=[s("i",{class:"el-icon-folder-opened"},null,-1),s("span",null,"分支设置",-1)])),_:1}),l(_,{index:"collaborators"},{default:t(()=>e[10]||(e[10]=[s("i",{class:"el-icon-user"},null,-1),s("span",null,"协作者",-1)])),_:1}),l(_,{index:"danger"},{default:t(()=>e[11]||(e[11]=[s("i",{class:"el-icon-warning"},null,-1),s("span",null,"危险操作",-1)])),_:1})]),_:1},8,["default-active","onSelect"])]),_:1}),l(k,{span:20},{default:t(()=>[V(l(c,{class:"settings-card"},{default:t(()=>[e[15]||(e[15]=s("div",{slot:"header"},[s("span",null,"基础设置")],-1)),l(U,{model:o.house,"label-width":"120px"},{default:t(()=>[l(d,{label:"名称"},{default:t(()=>[l(h,{modelValue:o.house.name,"onUpdate:modelValue":e[0]||(e[0]=n=>o.house.name=n),placeholder:"名称"},null,8,["modelValue"])]),_:1}),l(d,{label:"描述"},{default:t(()=>[l(h,{modelValue:o.house.description,"onUpdate:modelValue":e[1]||(e[1]=n=>o.house.description=n),type:"textarea",rows:3,placeholder:"描述"},null,8,["modelValue"])]),_:1}),l(d,{label:"可见性"},{default:t(()=>[l(T,{modelValue:o.house.kind,"onUpdate:modelValue":e[2]||(e[2]=n=>o.house.kind=n)},{default:t(()=>[l(p,{label:0,value:0},{default:t(()=>e[12]||(e[12]=[i("Public")])),_:1}),l(p,{label:1,value:1},{default:t(()=>e[13]||(e[13]=[i("Private")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:t(()=>[l(b,{type:"primary",loading:o.saving,onClick:m.saveSettings},{default:t(()=>e[14]||(e[14]=[i(" 确认修改 ")])),_:1},8,["loading","onClick"])]),_:1})]),_:1},8,["model"])]),_:1},512),[[C,o.activeTab==="general"]]),V(l(c,{class:"settings-card"},{default:t(()=>e[16]||(e[16]=[s("div",{slot:"header"},[s("span",null,"分支管理")],-1)])),_:1},512),[[C,o.activeTab==="branches"]]),V(l(c,{class:"settings-card"},{default:t(()=>[e[18]||(e[18]=s("div",{slot:"header"},[s("span",null,"协作者管理")],-1)),s("div",j,[s("div",null,[(f(!0),y(w,null,S(o.collaborators,n=>(f(),x(N,{key:n.id,closable:"",onClose:P=>m.removeCollaborator(n),onClick:P=>m.showCollaborator(n)},{default:t(()=>[i(L(n.name),1)]),_:2},1032,["onClose","onClick"]))),128))]),l(W),s("div",q,[l(b,{type:"primary",icon:"el-icon-plus",onClick:m.addCollaborator},{default:t(()=>e[17]||(e[17]=[i("授权")])),_:1},8,["onClick"])])])]),_:1},512),[[C,o.activeTab==="collaborators"]]),V(l(c,{class:"danger-zone"},{default:t(()=>[e[22]||(e[22]=s("div",{slot:"header"},[s("span",{class:"danger-title"},"危险区域")],-1)),s("div",A,[e[20]||(e[20]=s("h4",null,"Delete Repository",-1)),e[21]||(e[21]=s("p",null,"This action cannot be undone...",-1)),l(D,{title:"确认删除仓库吗？",onConfirm:m.deleteRepository},{default:t(()=>[l(b,{slot:"reference",type:"danger",disabled:!o.isOwner},{default:t(()=>e[19]||(e[19]=[i(" 删除 ")])),_:1},8,["disabled"])]),_:1},8,["onConfirm"])])]),_:1},512),[[C,o.activeTab==="danger"]])]),_:1})]),_:1})]),l(R,{modelValue:o.vis,"onUpdate:modelValue":e[6]||(e[6]=n=>o.vis=n)},{default:t(()=>[l(U,{"label-width":"120px"},{default:t(()=>[l(d,{label:"用户名"},{default:t(()=>[l(h,{modelValue:o.setting.username,"onUpdate:modelValue":e[3]||(e[3]=n=>o.setting.username=n),placeholder:"用户名"},null,8,["modelValue"])]),_:1}),o.setting.right!="C"?(f(),x(d,{key:0,label:"授权分支"},{default:t(()=>[l(M,{modelValue:o.setting.branch,"onUpdate:modelValue":e[4]||(e[4]=n=>o.setting.branch=n)},{default:t(()=>[l(B,{label:"all",value:"all"}),(f(!0),y(w,null,S(o.branches,n=>(f(),x(B,{label:n,value:n},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})):O("",!0),l(d,{label:"权限"},{default:t(()=>[l(T,{modelValue:o.setting.right,"onUpdate:modelValue":e[5]||(e[5]=n=>o.setting.right=n)},{default:t(()=>[l(p,{value:"RW+"},{default:t(()=>e[23]||(e[23]=[i("RW+")])),_:1}),l(p,{value:"RW"},{default:t(()=>e[24]||(e[24]=[i("RW")])),_:1}),l(p,{value:"R"},{default:t(()=>e[25]||(e[25]=[i("R")])),_:1}),l(p,{value:"C"},{default:t(()=>e[26]||(e[26]=[i("Create")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:t(()=>[l(b,{type:"primary",onClick:m.sureCollaborator},{default:t(()=>e[27]||(e[27]=[i(" 确认 ")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(R,{modelValue:o.infovis,"onUpdate:modelValue":e[7]||(e[7]=n=>o.infovis=n)},null,8,["modelValue"])],64)}const Q=F(z,[["render",G],["__scopeId","data-v-5db5fd5d"]]);export{Q as default};

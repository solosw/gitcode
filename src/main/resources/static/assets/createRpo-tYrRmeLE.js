import{_ as P,c as _,o as d,f as t,b as l,d as s,e as c,E as p,F as I,m as T,a as k,g as n,t as C}from"./index-CeHthxjz.js";const S={name:"RepoCreate",data(){return{user:JSON.parse(localStorage.getItem("user")).user,form:{name:"",path:"",belongsTo:-1,description:"",readme:!1,visibility:"0"},userIdentity:[]}},created(){c.post("/user/getIdentityList/"+this.user.id).then(i=>{i.data.status==200?this.userIdentity=i.data.data:p(i.data.message)})},methods:{getPrefixPath(){return this.form.belongsTo==-1?this.user.name+"/":this.userIdentity[this.form.belongsTo].name+"/"+this.user.name+"/"},onSubmit(){this.$refs.repoForm.validate(i=>{if(i){var e={name:this.form.name,path:this.getPrefixPath()+this.form.path,creatorId:this.user.id,kind:this.form.visibility,type:this.form.belongsTo==-1?0:1,origizationId:this.form.belongsTo==-1?null:this.userIdentity[this.form.belongsTo].id,description:this.form.description};c.post("/house/create",e).then(u=>{u.data.status==200?(alert("创建成功"),location.href="/index"):p(u.data.message)})}else return p("请检查填写类容"),!1})}}},U={class:"repo-create"};function B(i,e,u,F,o,f){const m=s("el-input"),a=s("el-form-item"),b=s("el-option"),h=s("el-select"),g=s("el-radio-button"),y=s("el-radio-group"),V=s("el-button"),v=s("el-form");return d(),_("div",U,[t(v,{model:o.form,"label-width":"120px",ref:"repoForm",style:{height:"100%"},"label-position":"top"},{default:l(()=>[t(a,{label:"Repository Name",prop:"name",rules:[{required:!0,message:"Please input repository name",trigger:"blur"}]},{default:l(()=>[t(m,{modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=r=>o.form.name=r)},null,8,["modelValue"])]),_:1}),t(a,{label:"Belongs to",prop:"belongsTo",rules:[{required:!0,message:"Please select a belonging",trigger:"change"}]},{default:l(()=>[t(h,{modelValue:o.form.belongsTo,"onUpdate:modelValue":e[1]||(e[1]=r=>o.form.belongsTo=r),placeholder:"Select"},{default:l(()=>[t(b,{label:o.user.name,value:-1},null,8,["label"]),(d(!0),_(I,null,T(o.userIdentity,(r,x)=>(d(),k(b,{label:r.name,value:x},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),t(a,{label:"Path",rules:[{required:!0,message:"Please input Path",trigger:"blur"}]},{default:l(()=>[t(m,{modelValue:o.form.path,"onUpdate:modelValue":e[2]||(e[2]=r=>o.form.path=r)},{prefix:l(()=>[n(C(f.getPrefixPath()),1)]),_:1},8,["modelValue"])]),_:1}),t(a,{label:"Description (optional)"},{default:l(()=>[t(m,{type:"textarea",modelValue:o.form.description,"onUpdate:modelValue":e[3]||(e[3]=r=>o.form.description=r)},null,8,["modelValue"])]),_:1}),t(a,{label:"Visibility"},{default:l(()=>[t(y,{modelValue:o.form.visibility,"onUpdate:modelValue":e[4]||(e[4]=r=>o.form.visibility=r)},{default:l(()=>[t(g,{label:"0"},{default:l(()=>e[5]||(e[5]=[n("Public")])),_:1}),t(g,{label:"1"},{default:l(()=>e[6]||(e[6]=[n("Private")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(a,null,{default:l(()=>[t(V,{type:"primary",onClick:f.onSubmit},{default:l(()=>e[7]||(e[7]=[n("Create Repository")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])])}const R=P(S,[["render",B],["__scopeId","data-v-eecd5b80"]]);export{R as default};

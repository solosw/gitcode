import{_ as w,c as y,o as p,h,f as a,b as l,d as r,e as U,E as n,N as V,a as _,g}from"./index-CeHthxjz.js";const x={computed:{UserFilled(){return V}},data(){return{user:JSON.parse(localStorage.getItem("user")).user,password:"",email:"",name:"",avatarUrl:"",uploadHeaders:{Authorization:"none"}}},methods:{handleAvatarSuccess(s){this.avatarUrl=s.data,n.success("头像上传成功")},beforeAvatarUpload(s){const e=["image/jpeg","image/png","image/jpg"].includes(s.type),d=s.size/1024/1024<5;return e||n.error("仅支持 JPG/PNG 格式!"),d||n.error("图片大小不能超过 5MB!"),e&&d},submit(){U.post("/user/changeInfo",{id:this.user.id,email:this.email,password:this.password,url:this.avatarUrl}).then(s=>{if(s.data.status==200){console.log(s.data.data),this.user=s.data.data,this.name=this.user.name,this.email=this.user.email,this.password=this.user.password,n("Success");var e={user:this.user};localStorage.setItem("user",JSON.stringify(e))}else n(s.data.message)})}},created(){this.user=JSON.parse(localStorage.getItem("user")).user,this.name=this.user.name,this.email=this.user.email,this.password=this.user.password,this.avatarUrl=this.user.av,this.uploadHeaders.Authorization=localStorage.getItem("token")}},S={style:{display:"flex","align-items":"center"}};function k(s,e,d,N,t,u){const c=r("el-avatar"),f=r("el-button"),v=r("el-upload"),o=r("el-form-item"),m=r("el-input"),b=r("el-form");return p(),y("div",null,[e[5]||(e[5]=h("h2",null,"账号设置",-1)),a(b,{"label-width":"100px",style:{width:"500px"}},{default:l(()=>[a(o,{label:"头像"},{default:l(()=>[h("div",S,[t.avatarUrl?(p(),_(c,{key:0,size:80,src:t.avatarUrl,style:{"margin-right":"20px"}},null,8,["src"])):(p(),_(c,{key:1,size:80,icon:u.UserFilled,style:{"margin-right":"20px"}},null,8,["icon"])),a(v,{action:"/back/files/upload","show-file-list":!1,"on-success":u.handleAvatarSuccess,"before-upload":u.beforeAvatarUpload,headers:t.uploadHeaders},{default:l(()=>[a(f,{type:"primary"},{default:l(()=>e[3]||(e[3]=[g("更换头像")])),_:1})]),_:1},8,["on-success","before-upload","headers"])])]),_:1}),a(o,{label:"用户名"},{default:l(()=>[a(m,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=i=>t.name=i),disabled:""},null,8,["modelValue"])]),_:1}),a(o,{label:"密码"},{default:l(()=>[a(m,{modelValue:t.password,"onUpdate:modelValue":e[1]||(e[1]=i=>t.password=i),placeholder:"新密码",type:"password"},null,8,["modelValue"])]),_:1}),a(o,{label:"邮箱"},{default:l(()=>[a(m,{modelValue:t.email,"onUpdate:modelValue":e[2]||(e[2]=i=>t.email=i),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),a(o,null,{default:l(()=>[a(f,{type:"primary",onClick:u.submit},{default:l(()=>e[4]||(e[4]=[g("保存")])),_:1},8,["onClick"])]),_:1})]),_:1})])}const I=w(x,[["render",k]]);export{I as default};

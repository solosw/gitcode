import{_ as A,q as I,s as M,u as E,x as F,c as u,o as c,f as n,b as s,d as o,e as O,F as g,m as f,a as C,n as S,h as i,g as y,t as d}from"./index-CeHthxjz.js";const N={components:{ElCard:F,ElTag:E,ElTimeline:M,ElTimelineItem:I},computed:{filteredCommits(){return JSON.parse(JSON.stringify(this.mockData)).filter(t=>{var r;const p=!this.selectedAuthor||t.author===this.selectedAuthor,b=!this.selectedBranch||t.branch===this.selectedBranch;let l=!0;if(((r=this.dateRange)==null?void 0:r.length)===2){const h=new Date(t.date),_=new Date(this.dateRange[0]),m=new Date(this.dateRange[1]);l=h>=_&&h<=m}return p&&b&&l})},authorOptions(){return[...new Set(this.mockData.map(a=>a.author))]},branchOptions(){return[...new Set(this.mockData.map(a=>a.branch))]}},created(){const a=new URLSearchParams(window.location.search);this.houseId=a.get("id"),O.post("/git/getHistory/"+this.houseId).then(t=>{t.data.status==200&&(this.mockData=t.data.data,this.processCommitData(this.mockData))})},data(){return{mockData:[],commits:[],branchColors:{main:"#67C23A","feature/login":"#E6A23C"},houseId:-1,selectedAuthor:"",selectedBranch:"",dateRange:[]}},mounted(){},methods:{handleFilterChange(){this.processCommitData(this.filteredCommits)},handleDateChange(a){this.dateRange=a,this.handleFilterChange()},processCommitData(a){this.commits=a.map(t=>({...t,isMerge:t.parents.length>1,timestamp:new Date(t.date).getTime()})).sort((t,p)=>p.timestamp-t.timestamp)},getBranchTagType(a){return a==="master"?"success":"warning"}}},U={class:"git-history-timeline"},J={class:"commit-header"},L={class:"message"},q={class:"commit-footer"},z={class:"commit-date"};function H(a,t,p,b,l,r){const h=o("el-option"),_=o("el-select"),m=o("el-form-item"),v=o("el-date-picker"),w=o("el-form"),V=o("el-tag"),D=o("el-link"),B=o("el-divider"),x=o("el-card"),T=o("el-timeline-item"),R=o("el-timeline");return c(),u("div",U,[n(w,{inline:!0,class:"filter-bar"},{default:s(()=>[n(m,{label:"作者筛选"},{default:s(()=>[n(_,{modelValue:l.selectedAuthor,"onUpdate:modelValue":t[0]||(t[0]=e=>l.selectedAuthor=e),placeholder:"选择作者",clearable:"",onChange:r.handleFilterChange,style:{width:"200px"}},{default:s(()=>[(c(!0),u(g,null,f(r.authorOptions,e=>(c(),C(h,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),n(m,{label:"分支筛选"},{default:s(()=>[n(_,{modelValue:l.selectedBranch,"onUpdate:modelValue":t[1]||(t[1]=e=>l.selectedBranch=e),placeholder:"选择分支",clearable:"",onChange:r.handleFilterChange,style:{width:"200px"}},{default:s(()=>[(c(!0),u(g,null,f(r.branchOptions,e=>(c(),C(h,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),n(m,{label:"时间范围"},{default:s(()=>[n(v,{modelValue:l.dateRange,"onUpdate:modelValue":t[2]||(t[2]=e=>l.dateRange=e),type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",onChange:r.handleDateChange},null,8,["modelValue","onChange"])]),_:1})]),_:1}),n(R,null,{default:s(()=>[(c(!0),u(g,null,f(l.commits,e=>(c(),C(T,{key:e.hash,timestamp:e.date,color:l.branchColors[e.branch],placement:"top",class:S(["timeline-node",{"merge-commit":e.isMerge}])},{default:s(()=>[n(x,{shadow:"hover",class:"commit-card"},{default:s(()=>[i("div",J,[n(V,{type:r.getBranchTagType(e.branch)},{default:s(()=>[y(d(e.branch),1)]),_:2},1032,["type"]),n(D,{href:"/commit?id="+l.houseId+"&&commit="+e.hash},{default:s(()=>[y(d(e.hash),1)]),_:2},1032,["href"])]),i("p",L,d(e.message),1),i("div",q,[i("span",null,"👤 "+d(e.author),1),i("span",z,"📅 "+d(e.date),1)]),i("div",null,[n(B),(c(!0),u(g,null,f(e.parents,k=>(c(),C(D,{href:"/commit?id="+l.houseId+"&&commit="+k},{default:s(()=>[y(d(k),1)]),_:2},1032,["href"]))),256))])]),_:2},1024)]),_:2},1032,["timestamp","color","class"]))),128))]),_:1})])}const j=A(N,[["render",H],["__scopeId","data-v-b9112171"]]);export{j as default};
